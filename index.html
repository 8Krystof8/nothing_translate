<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nothing Translator (Data Core)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&family=Silkscreen&family=Space+Mono:ital,wght@0,400;0,700;1,400&display=swap" rel="stylesheet">

    <style>
        :root {
            --nothing-red: #D71921;
            --nothing-dark: #0a0a0a;
            --nothing-grey: #262626;
            --nothing-text: #E6E6E6;
        }

        body {
            font-family: 'Inter', sans-serif;
            background-color: #000000;
            background-image: radial-gradient(#333 1px, transparent 1px);
            background-size: 24px 24px;
            color: var(--nothing-text);
            overflow-x: hidden;
        }

        .font-nothing { font-family: 'Silkscreen', cursive; }
        .font-mono-tech { font-family: 'Space Mono', monospace; }

        textarea {
            caret-color: var(--nothing-red);
        }
        
        textarea::-webkit-scrollbar { width: 8px; }
        textarea::-webkit-scrollbar-track { background: transparent; }
        textarea::-webkit-scrollbar-thumb { background-color: #333; border-radius: 4px; }
        textarea::-webkit-scrollbar-thumb:hover { background-color: #555; }

        .glass-panel {
            background: rgba(20, 20, 20, 0.7);
            backdrop-filter: blur(25px);
            -webkit-backdrop-filter: blur(25px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
        }

        .dot-texture {
            background-image: radial-gradient(rgba(255,255,255,0.15) 1px, transparent 0);
            background-size: 4px 4px;
            opacity: 0.3;
        }

        /* Modal Styles */
        .modal-overlay {
            animation: fadeIn 0.2s ease-out forwards;
        }
        
        .modal-content {
            animation: scaleUp 0.3s cubic-bezier(0.16, 1, 0.3, 1) forwards;
        }

        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes scaleUp { from { transform: scale(0.95); opacity: 0; } to { transform: scale(1); opacity: 1; } }

        /* Select Styles */
        select {
            appearance: none;
            background-color: transparent;
            border: none;
            color: inherit;
            font-family: 'Silkscreen', cursive;
            font-size: 10px;
            cursor: pointer;
            text-transform: uppercase;
            padding-right: 1.5em;
            background-image: url("data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23D71921%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E");
            background-repeat: no-repeat;
            background-position: right 0 center;
            background-size: 8px auto;
        }
        select:focus { outline: none; }
        
        .lang-badge {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 4px 8px;
            border-radius: 4px;
            transition: all 0.3s ease;
        }
        .lang-badge:hover {
            background: rgba(255, 255, 255, 0.15);
            border-color: var(--nothing-red);
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center p-4 sm:p-8 relative">

    <div class="w-full max-w-4xl glass-panel rounded-[2rem] overflow-hidden flex flex-col relative transition-all duration-500 z-10">
        
        <!-- Header -->
        <header class="flex justify-between items-center p-6 border-b border-white/10 bg-black/20">
            <div class="flex items-center gap-3">
                <div class="w-3 h-3 rounded-full bg-[#333] border border-white/10"></div>
                <div class="w-3 h-3 rounded-full bg-[#333] border border-white/10"></div>
                
                <!-- Data Trigger Button -->
                <div 
                    title="Open Data Console"
                    onclick="toggleConsole()" 
                    class="w-3 h-3 rounded-full bg-[#262626] border border-white/10 cursor-pointer hover:bg-[var(--nothing-red)] transition-colors duration-300 animate-pulse"
                    id="dbStatusDot"
                ></div>
            </div>
            
            <div class="flex flex-col items-end">
                <h1 class="font-nothing text-xl sm:text-2xl tracking-tighter uppercase text-white">Translator<span class="text-[#D71921]">(1)</span></h1>
                <div class="text-[9px] font-mono-tech text-gray-500 tracking-widest">DATA_CORE_V3</div>
            </div>
        </header>

        <!-- Content -->
        <main class="flex flex-col md:flex-row h-[500px]">
            
            <!-- Input Section -->
            <div class="flex-1 relative group border-b md:border-b-0 md:border-r border-white/10 flex flex-col">
                <div class="absolute top-4 left-6 z-10 lang-badge">
                    <select id="sourceLang" onchange="processText()">
                        <option value="en" selected>English</option>
                        <option value="cs">Czech</option>
                        <option value="de">German</option>
                        <option value="fr">French</option>
                        <option value="es">Spanish</option>
                        <option value="it">Italian</option>
                        <option value="ru">Russian</option>
                    </select>
                </div>
                
                <textarea 
                    id="inputText"
                    class="w-full h-full bg-transparent p-6 pt-16 text-2xl resize-none focus:outline-none font-light text-white/90 placeholder-gray-700 leading-relaxed"
                    placeholder="Enter text..."
                ></textarea>

                <button onclick="clearText()" class="absolute top-4 right-6 p-2 opacity-50 hover:opacity-100 transition-opacity duration-300 hover:bg-white/10 rounded-full text-gray-400 hover:text-white">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>
                </button>
            </div>

            <!-- Output Section -->
            <div class="flex-1 relative bg-[#050505] group flex flex-col">
                <div class="absolute inset-0 dot-texture pointer-events-none"></div>
                
                <div class="absolute top-4 left-6 z-10 flex gap-2 items-center">
                    <div class="lang-badge bg-[var(--nothing-red)]/10 border-[var(--nothing-red)]/30">
                        <select id="targetLang" onchange="processText()" class="text-[var(--nothing-red)]">
                            <option value="cs" selected>Czech</option>
                            <option value="en">English</option>
                            <option value="de">German</option>
                            <option value="fr">French</option>
                            <option value="es">Spanish</option>
                            <option value="it">Italian</option>
                            <option value="ru">Russian</option>
                        </select>
                    </div>
                    
                    <span id="matchIndicator" class="hidden font-mono-tech text-[10px] border border-white/20 text-white/40 px-2 py-1 rounded-sm">DB_MATCH</span>
                </div>

                <!-- Loading Overlay -->
                <div id="loadingIndicator" class="hidden absolute inset-0 flex items-center justify-center bg-black/80 z-20 backdrop-blur-sm">
                    <div class="flex flex-col items-center gap-2">
                        <div class="font-nothing text-xl animate-pulse text-[var(--nothing-red)]">TRANSLATING...</div>
                    </div>
                </div>

                <textarea 
                    id="outputText"
                    readonly
                    class="w-full h-full bg-transparent p-6 pt-16 text-2xl resize-none focus:outline-none font-mono-tech text-[var(--nothing-red)] leading-relaxed"
                    placeholder="..."
                ></textarea>

                <button onclick="copyToClipboard()" class="absolute bottom-6 right-6 flex items-center gap-2 px-4 py-2 bg-white/5 border border-white/10 rounded-full hover:bg-white/10 transition-all text-gray-400 hover:text-white active:scale-95 z-10">
                    <span class="font-mono-tech text-xs uppercase">Copy</span>
                    <svg xmlns="http://www.w3.org/2000/svg" width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/></svg>
                </button>
            </div>
        </main>

        <!-- Footer -->
        <footer class="bg-[#0a0a0a] border-t border-white/10 text-gray-500 p-3 flex justify-between items-center text-[10px] font-mono-tech uppercase tracking-widest">
            <div class="flex items-center gap-2">
                <div id="systemStatus" class="w-2 h-2 rounded-full bg-green-500 shadow-[0_0_5px_rgba(34,197,94,0.5)]"></div>
                <span id="statusText">ONLINE</span>
            </div>
            <div class="flex gap-4 opacity-50">
                <span>BAT: 100%</span>
                <span>LOC: PRG</span>
            </div>
        </footer>
    </div>

    <!-- DATA CONSOLE MODAL -->
    <div id="consoleModal" class="hidden fixed inset-0 z-50 flex items-center justify-center bg-black/90 backdrop-blur-sm modal-overlay p-4">
        <div class="w-full max-w-xl bg-[#111] border border-white/20 rounded-2xl overflow-hidden shadow-2xl flex flex-col modal-content">
            <!-- Modal Header -->
            <div class="p-4 border-b border-white/10 flex justify-between items-center bg-white/5">
                <div class="flex items-center gap-2">
                    <div class="w-2 h-2 bg-[var(--nothing-red)] rounded-full"></div>
                    <h2 class="font-nothing text-white text-sm">DATA CONSOLE</h2>
                </div>
                <button onclick="toggleConsole()" class="text-gray-500 hover:text-white transition-colors">
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                </button>
            </div>
            
            <!-- Modal Body -->
            <div class="p-6 flex flex-col gap-4">
                <p class="font-mono-tech text-[10px] text-gray-400 uppercase tracking-wider">Option A: Paste JSON Text</p>
                <textarea 
                    id="manualJsonInput" 
                    class="w-full h-32 bg-[#0a0a0a] border border-white/10 p-3 font-mono-tech text-xs text-[#D71921] focus:outline-none focus:border-[#D71921] rounded-lg resize-none placeholder-white/20" 
                    placeholder='Example: [{"q": "Hello", "a": "Ahoj"}]'></textarea>
                
                <div class="flex items-center gap-4">
                    <div class="h-px bg-white/10 flex-1"></div>
                    <span class="font-mono-tech text-[10px] text-gray-600">OR</span>
                    <div class="h-px bg-white/10 flex-1"></div>
                </div>

                <p class="font-mono-tech text-[10px] text-gray-400 uppercase tracking-wider">Option B: Load File</p>
                <div class="flex gap-2">
                    <label class="flex-1 cursor-pointer bg-[#1a1a1a] border border-white/10 text-gray-400 hover:text-white hover:border-white/30 py-2 px-4 rounded-lg font-mono-tech text-xs text-center transition-all">
                        <span>SELECT .JSON FILE</span>
                        <input type="file" accept=".json" class="hidden" onchange="handleFileSelect(this)">
                    </label>
                </div>
            </div>

            <!-- Modal Footer -->
            <div class="p-4 border-t border-white/10 flex justify-end bg-white/5">
                <button onclick="loadManualData()" class="bg-[#D71921] hover:bg-red-600 text-white font-nothing text-xs px-6 py-3 rounded-lg transition-colors shadow-lg">
                    LOAD DATA
                </button>
            </div>
        </div>
    </div>

    <script>
        const inputText = document.getElementById('inputText');
        const outputText = document.getElementById('outputText');
        const loadingIndicator = document.getElementById('loadingIndicator');
        const dbStatusDot = document.getElementById('dbStatusDot');
        const matchIndicator = document.getElementById('matchIndicator');
        const sourceLangSelect = document.getElementById('sourceLang');
        const targetLangSelect = document.getElementById('targetLang');
        const consoleModal = document.getElementById('consoleModal');
        const manualJsonInput = document.getElementById('manualJsonInput');
        
        let debounceTimer;
        let customDatabase = {};

        // --- CONSOLE & DATA LOGIC ---

        function toggleConsole() {
            consoleModal.classList.toggle('hidden');
            if (!consoleModal.classList.contains('hidden')) {
                manualJsonInput.focus();
            }
        }

        function loadManualData() {
            const rawData = manualJsonInput.value.trim();
            if (!rawData) {
                toggleConsole(); // Close if empty
                return;
            }
            try {
                const data = JSON.parse(rawData);
                parseAndSetData(data);
                manualJsonInput.value = ''; // Clear after success
                toggleConsole();
            } catch (e) {
                alert("Invalid JSON format. Please check your syntax.");
            }
        }

        function handleFileSelect(input) {
            const file = input.files[0];
            if (!file) return;
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    parseAndSetData(data);
                    toggleConsole();
                } catch (err) {
                    alert("JSON Error: File format incorrect.");
                }
            };
            reader.readAsText(file);
        }

        function parseAndSetData(data) {
            // Reset DB
            customDatabase = {};
            
            // Normalize data
            if (Array.isArray(data)) {
                data.forEach(item => {
                    const q = item.q || item.question || item.otazka;
                    const a = item.a || item.answer || item.odpoved;
                    if (q && a) customDatabase[q.trim()] = a;
                });
            } else {
                customDatabase = data;
            }
            
            // Visual Success Indicators
            dbStatusDot.style.backgroundColor = '#28C840';
            dbStatusDot.classList.remove('animate-pulse');
            dbStatusDot.title = "Database Loaded";
            document.getElementById('statusText').innerText = "DB LOADED";
            
            // Trigger re-check
            processText();
        }

        // --- INPUT HANDLING ---

        inputText.addEventListener('input', () => {
            clearTimeout(debounceTimer);
            if (inputText.value.trim() === '') {
                outputText.value = '';
                matchIndicator.classList.add('hidden');
                return;
            }
            debounceTimer = setTimeout(processText, 800);
        });

        // --- CORE LOGIC ---

        async function processText() {
            const text = inputText.value.trim();
            if (!text) return;

            // 1. Check Cheat Sheet (Database) FIRST
            const cleanText = text.replace(/\s+/g, ' ').trim();
            let answer = customDatabase[cleanText] || customDatabase[text];
            
            if (!answer) {
                const lowerKey = cleanText.toLowerCase();
                const foundKey = Object.keys(customDatabase).find(k => k.toLowerCase().replace(/\s+/g, ' ').trim() === lowerKey);
                if (foundKey) answer = customDatabase[foundKey];
            }

            if (answer) {
                outputText.value = answer;
                outputText.style.color = "#D71921"; // Highlight answer
                matchIndicator.classList.remove('hidden');
                return;
            } 

            // 2. Standard Translation
            matchIndicator.classList.add('hidden');
            outputText.style.color = "#E6E6E6"; 
            performTranslation(text);
        }

        async function performTranslation(text) {
            const source = sourceLangSelect.value;
            const target = targetLangSelect.value;
            
            loadingIndicator.classList.remove('hidden');
            outputText.classList.add('blur-sm');

            try {
                const url = `https://api.mymemory.translated.net/get?q=${encodeURIComponent(text)}&langpair=${source}|${target}`;
                const response = await fetch(url);
                const data = await response.json();

                if (data.responseStatus === 200) {
                    outputText.value = data.responseData.translatedText;
                } else {
                    outputText.value = "Limit reached or error.";
                }
            } catch (error) {
                outputText.value = "Connection error.";
            } finally {
                loadingIndicator.classList.add('hidden');
                outputText.classList.remove('blur-sm');
            }
        }

        function clearText() {
            inputText.value = '';
            outputText.value = '';
            matchIndicator.classList.add('hidden');
            inputText.focus();
        }

        function copyToClipboard() {
            outputText.select();
            document.execCommand('copy');
            const btn = document.querySelector('button[onclick="copyToClipboard()"] span');
            const original = btn.innerText;
            btn.innerText = "COPIED";
            setTimeout(() => btn.innerText = original, 1500);
        }
    </script>
</body>
</html>
